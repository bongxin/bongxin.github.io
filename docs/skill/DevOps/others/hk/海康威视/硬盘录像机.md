# 硬盘录像机映射外网获取视频流

对于海康威视（Hikvision）品牌的NVR，您可以按照以下步骤来配置通过互联网访问内网摄像头的RTSP视频流。海康设备通常具有较为完善的网络和远程访问功能，下面是一个详细的指南：

## 1. 确认NVR和摄像头连接

确保所有摄像头已正确连接到NVR，并且在NVR的管理界面中可以正常查看每个摄像头的实时视频。

## 2. 配置NVR网络设置

- 登录NVR：使用浏览器输入NVR的IP地址（例如 http://<NVR_IP>），并使用管理员账号登录。
- 静态IP地址：进入“配置” -> “网络” -> “TCP/IP”，为NVR分配一个静态IP地址，以便于端口转发时更方便地定位设备。
- 启用RTSP服务：在“配置” -> “编码” -> “Live Stream”中，确保启用了RTSP服务。记录下RTSP路径格式，通常为：

``` sh
rtsp://<NVR_IP>:554/Streaming/channels/<channel_number>01
```

其中 <channel_number> 是摄像头的通道号，例如第一个摄像头可能是 1，第二个是 2，以此类推。

## 3. 配置路由器端口转发

登录路由器：进入路由器的管理界面（通常是通过浏览器访问路由器的IP地址）。
端口转发设置：找到“端口转发”或“虚拟服务器”选项，添加新的转发规则：
外部端口：选择一个外部端口（如 554 或其他未被占用的端口）。
内部端口：与外部端口相同，指向NVR的内部IP地址和RTSP端口（默认是 554）。
协议：选择 TCP 或 UDP，或者同时选择两者。

## 4. 使用DDNS服务（如果需要）

如果您的公网IP地址是动态变化的，建议使用DDNS服务。海康NVR支持多种DDNS服务，您可以在NVR的“配置” -> “网络” -> “域名”中进行设置。选择一个支持的服务（如 HiDDNS），并根据提示完成配置。

## 5. 访问视频流

一旦完成上述配置，您可以通过以下URL访问摄像头的RTSP视频流：

``` sh
rtsp://<公网IP或DDNS域名>:<外部端口>/Streaming/channels/<channel_number>01
```

例如，如果您的公网IP是 203.0.113.1，外部端口是 554，第一个摄像头的视频流URL将是：

``` sh
rtsp://203.0.113.1:554/Streaming/channels/101
```

如果使用了DDNS域名 mydvr.example.com，则URL变为：

``` sh
rtsp://mydvr.example.com:554/Streaming/channels/101
```

## 6. 安全性考虑

- 强密码保护：为NVR设置复杂的管理员密码，避免使用默认密码。
- 加密通信：尽可能使用HTTPS/SSL加密连接，保护数据传输的安全性。
- 防火墙设置：确保只有必要的端口被对外开放，限制其他不必要的端口暴露在外。
- 定期更新固件：保持NVR系统的最新状态，及时安装厂商发布的安全补丁和功能更新。

## 海康专用工具

海康威视还提供了一些专用工具和应用程序，可以帮助您更方便地进行远程访问和管理：

- iVMS-4200：这是海康威视提供的PC端软件，支持对NVR和摄像头进行集中管理和监控。
- Hik-Connect App：适用于iOS和Android设备，允许您通过手机随时随地查看摄像头视频流。